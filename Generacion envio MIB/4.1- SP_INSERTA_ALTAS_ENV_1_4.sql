------------ORIGINAL---------------------

CREATE OR REPLACE PROCEDURE SP_INS_ALTAS_ENV_1_4
AS
CURSOR CTO_CUR IS
SELECT CONCALT,CONNOM,CONAP1,CONAP2,CONVIA,CONNVIA,CONNUEX,CONNUIN,CONEDIF,
       CONMANZ,CONLOTE,CONCOLO,CONCPO,CONPOB,CONUHA,CONENTR,DUP,CONENVIO,
       CONSUSCRIP,CONOFCR,CONEDO
FROM MP_PRMALTASM
WHERE CONMAR=50
AND CONPRM=1
AND CONCALT IN (SELECT CLAVE FROM MP_ESTADISTICA
                WHERE ENTREGA_MES = ('1811') --CAMBIAR EL MES Anterior--
                AND NO_ENVIO_MES BETWEEN 1 AND 2
                AND ORIGEN='01')
AND CONCOLO IS NOT NULL
AND CONSUSCRIP IS NULL
AND SUSPENCION_ENVIOS IS NULL
AND CONENVIO BETWEEN 1 AND 2;

 CTO_REC CTO_CUR%ROWTYPE;

BEGIN

OPEN CTO_CUR;

  LOOP
   FETCH CTO_CUR INTO CTO_REC;
    EXIT WHEN CTO_CUR%NOTFOUND;

 BEGIN

     INSERT INTO ALTAS(CON_ID,CONNOM,CONAP1,CONAP2,CONTIPO,CONNVIA,CONNUEX,CONNUIN,
                  CONEDIF,CONMANZ,CONLOTE,CONPOBA,CONCPO,CONMUNI,CONUHA,CONENTR,DUP,
                  NUM_COD,CONSUS,CONADM,CONEDO,CONTPER)
     VALUES (CTO_REC.CONCALT,CTO_REC.CONNOM,CTO_REC.CONAP1,CTO_REC.CONAP2,CTO_REC.CONVIA,
            CTO_REC.CONNVIA,CTO_REC.CONNUEX,CTO_REC.CONNUIN,CTO_REC.CONEDIF,
            CTO_REC.CONMANZ,CTO_REC.CONLOTE,CTO_REC.CONCOLO,CTO_REC.CONCPO,CTO_REC.CONPOB,CTO_REC.CONUHA,
            CTO_REC.CONENTR,CTO_REC.DUP,CTO_REC.CONENVIO,CTO_REC.CONSUSCRIP,CTO_REC.CONOFCR,CTO_REC.CONEDO,'1H');

     EXCEPTION WHEN OTHERS THEN

           NULL;

  END;

END LOOP;

  CLOSE CTO_CUR;

      COMMIT;

END;








-------------------------POR SI NO ACOMPLETA -------------------------
CREATE OR REPLACE PROCEDURE SP_INS_ALTAS_ENV_1_4
AS
CURSOR CTO_CUR IS
SELECT CONCALT,CONNOM,CONAP1,CONAP2,CONVIA,CONNVIA,CONNUEX,CONNUIN,CONEDIF,
       CONMANZ,CONLOTE,CONCOLO,CONCPO,CONPOB,CONUHA,CONENTR,DUP,CONENVIO,
       CONSUSCRIP,CONOFCR,CONEDO
FROM MP_PRMALTASM
WHERE CONMAR=50
AND CONPRM=1
AND CONCALT IN (SELECT CLAVE FROM MP_ESTADISTICA
                WHERE ENTREGA_MES IN ('1809','1810') --CAMBIAR EL MES--
                AND NO_ENVIO_MES BETWEEN 2 AND 2
                AND ORIGEN='01')
AND CONCOLO IS NOT NULL
AND CONSUSCRIP IS NULL
AND SUSPENCION_ENVIOS IS NULL
AND CONENVIO BETWEEN 2 AND 2
AND ROWNUM <= 5000;

 CTO_REC CTO_CUR%ROWTYPE;

BEGIN

OPEN CTO_CUR;

  LOOP
   FETCH CTO_CUR INTO CTO_REC;
    EXIT WHEN CTO_CUR%NOTFOUND;

 BEGIN

     INSERT INTO ALTAS(CON_ID,CONNOM,CONAP1,CONAP2,CONTIPO,CONNVIA,CONNUEX,CONNUIN,
                  CONEDIF,CONMANZ,CONLOTE,CONPOBA,CONCPO,CONMUNI,CONUHA,CONENTR,DUP,
                  NUM_COD,CONSUS,CONADM,CONEDO,CONTPER)
     VALUES (CTO_REC.CONCALT,CTO_REC.CONNOM,CTO_REC.CONAP1,CTO_REC.CONAP2,CTO_REC.CONVIA,
            CTO_REC.CONNVIA,CTO_REC.CONNUEX,CTO_REC.CONNUIN,CTO_REC.CONEDIF,
            CTO_REC.CONMANZ,CTO_REC.CONLOTE,CTO_REC.CONCOLO,CTO_REC.CONCPO,CTO_REC.CONPOB,CTO_REC.CONUHA,
            CTO_REC.CONENTR,CTO_REC.DUP,CTO_REC.CONENVIO,CTO_REC.CONSUSCRIP,CTO_REC.CONOFCR,CTO_REC.CONEDO,'1H');

     EXCEPTION WHEN OTHERS THEN

           NULL;

  END;

END LOOP;

  CLOSE CTO_CUR;

      COMMIT;

END;
